

За почетак, докажимо да је број различитих потпалиндрома неког стринга мањи или једнак дужини стринга. Доказ индукцијом по дужини стринга. За стрингове дужине $1$ тврђење очигледно важи. Нека је $S$ стринг дужине $n = |S| > 1$ и нека је $S' = S_1S_2\ldots S_{n-1}$. Посматрајмо све суфиксе од $S$ који су палиндроми. Сви осим најдужег суфикса се сигурно јављају и у $S'$ јер су они уједно прави префикси најдужег суфикс палиндрома. Одавде следи да $S$ има највише $1$ потпалиндром више од $S'$ што доказује тврђење. Стрингове који задовољавају једнакост ове теореме зваћемо **пуним**.

Корисно је приметити да, уколико је $S$ пун стринг, тада је и сваки његов префикс такође пун стринг, што нам омогућава да овакве стрингове генеришемо рекурзивно, тако што на тренутни пун стринг додајемо карактер $0$ или $1$, све док вредност овог броја не достигне горњу границу, када излазимо из рекурзије. Ову рекурзију можемо убрзати на следећи начин:

* Уместо са стринговима, радити са бит маскама. Све потребне операције са стринговима могу се имплементирати као битовске операције на бројевима.
* Током рекурзије чувати скуп потпалиндрома за тренутни број. Унутар једног корака рекурзије овај скуп ће се променити за тачно један елемент.
* Проверавамо само најдужи суфикс палиндром новогенерисаног броја. Из доказа теореме знамо да је довољно посматрати само њега.
* Поред самог броја, чувати и обрнут запис тог броја у рекурзији како би се избегло његово обртање при тражењу најдужег суфикс палиндрома.

Са овим опсервацијама, сложеност рекурзивне функције може се спустити на $O(m)$ по позиву, где је $m$ највећа дужина бинарног записа бројева. Укупна сложеност целог алгоритма је онда $O(mk)$, где је $k$ број пронађених пуних стрингова. Како је $k < 10^{10}$ чак и за последњи, највећи пример, време извршења целог програма је неколико десетина минута.
