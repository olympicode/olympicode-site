
## Анализа
Најпре ћемо објаснити решење које ради у сложености $O(n^2 \cdot h)$, што је довољно да се освоји 70 поена, а затим ћемо показати како се то решење може једноставно изменити тако да ради у сложености $O(n \cdot h)$ и донесе 100 поена.

## Решење у $O(n^2 \cdot h)$
Ово решење добијамо једноставним симулирањем протокоа. Наиме, за свако $i = 1 \ldots n$ "пустимо" јединични проток са врха водопада $i$-те колоне и симулирамо понашање тог јединичног протока. Кад проток удари у стену, тада га преусмеравамо лево или десно пратећи правила описана у поставци задатка. Када проток заврши на дну водопада у колони $j$ тада увећамо за $1$ испис за колону $j$.

Да бисмо проток који удари у стену правилно поделили лево и десно, приметимо прво да поставку проблема можемо преформулисати на следећи начин. Посматрајмо блок стена $B$.
- Ако је $B$ у непарном реду, тада се непарни по реду проток који удари у $B$ преусмерава лево, док се парни по реду проток који удари у $B$ преусмерава десно.
- Ако је $B$ у парном реду, тада се непарни по реду проток који удари у $B$ преусмерава десно, док се парни по реду проток који удари у $B$ преусмерава лево.

Дакле, за симулацију је довољно да за сваки блок стена памтимо где смо \emph{последњи} пут преусмерили проток са тог блока.

У овом решењу имамо $n$ јединичних протока које симулирамо "поље по поље". Пошто блок стена може имати дужину $n - 1$, дати проток може обићи $O(n \cdot h)$ поља пре него што дође до дна. Одатле следи горе назначено време извршавања.

## Решење у $O(n \cdot h)$
Да бисмо убрзали описано решење изнад, довољно је да за сваки блок стена запамтимо где су крај и почетак блока. Тада када проток удари било где у блок можемо га одмах симулирати са једног од крајева блока, без потребе да проток поље по поље прелази преко целог блока стена. То значи да се сваки ред може симулирати у $O(1)$ времену, што даје укупну сложеност од $O(n \cdot h)$.

## Смернице за алгоритам
За алгоритам је потребно да означимо ком блоку свака стена припада, као и да за сваки блок одредимо његов почетак и крај. Да бисмо то урадили, најпре ћемо сваком блоку узастопних стена доделити јединствен број, на пример, редом бројеве почевши од $1$. То можемо урадити на следећи начин. Чуваћемо променљиву $blockNumber$, која ће означавати редни број тренутног блока, и обилазити поља редом по редовима. Када наиђемо на стену, она је почетак новог блока ако и само ако је та стена прва у том реду, или ако је претходно поље било $1$. Када детектујемо почетак блока, тада увећамо $blockNumber$ за $1$. Стени, била прва у блоку или не, доделимо $blockNumber$.

После ових корака свакој стени је додељен број који означава ком блоку она припада. Стена блока са најмањом колоном означава почетак одговарајућег блока, а стена блока са највећом колоном означава крај одговарајућег блока.

## Бонус задатак
Симулација која доноси 100 поена кључно зависи од чињенице да постоји $n$ јединичних протока. Како би се могао овај задатак решити у $O(n \cdot h)$ времену ако се са врха водопада из $i$-те колоне пушта између $0$ и $10^9$ запремине воде?
