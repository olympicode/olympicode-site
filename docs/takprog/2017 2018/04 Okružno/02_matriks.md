## Анализа

Пођимо од наивног решења: ако за сваки упит рачунамо тражени $\text{xor}$ проласком кроз целу подматрицу укупна временска сложеност је $\mathcal{O}(qnm)$, што је довољно за **први подзадатак** у ком важи $1\leq n,m,q \leq 100$.

Означимо вредност израза који треба израчунати за неку подматрицу са $S$. У наставку ћемо операцију  $\text{xor}$ означавати симболом $\oplus$. Важи $S = A_{x_ly_l} \oplus \ldots\oplus  A_{x_ry_r} = (x_l \oplus y_l) \oplus \ldots \oplus (x_r \oplus y_r)$. Означимо сада $S_x = x_l \oplus \ldots \oplus x_r$ и $S_y = y_l \oplus \ldots \oplus y_r$. Независним разматрањем чланова по $x$ и по $y$ у изразу за $S$ добијамо $S = (S_x \oplus \ldots \oplus S_x) \oplus (S_y \oplus \ldots \oplus S_y)$ при чему прва заграда има $\Delta y=y_r - y_l + 1$, а друга $\Delta x=x_r - x_l + 1$ чланова (ширина и висина подматрице). Оваква репрезентација следи из комутативности операције $\text{xor}$ и представља основу за побољшање нашег решења.

Искористићемо познато својство операције $\text{xor}$: за свако $a$ важи $a \oplus a = 0$. Из овога следи да je вредност израза $a \oplus \ldots \oplus a$ једнака $a$ ако имамо непаран број чланова, а $0$ у супротном. Ако применимо ово на добијену репрезентацију $S$ добијамо да је вредност прве заграде једнака $S_x$  када је $\Delta y$ непарно, а $0$ када је парно. На исти начин вредност друге заграде је $S_y$ када је $\Delta x$ непарно, а $0$ када је парно. Дакле, ако наивно израчунамо вредности $S_x$ и $S_y$ можемо у зависности од парности димензија подматрице наћи $\text{xor}$ свих њених вредности. Ово нас доводи до укупне временске сложености од $\mathcal{O}(q(n+m))$ што је довољно за **други подзадатак** у ком важи $1\leq n,m \leq 1000$.

Покушајмо да убрзамо рачунање вредности $S_x$ и $S_y$. Ако означимо са $P(a) = 1 \oplus \ldots \oplus a$ видимо да је $S_x = P(x_r) \oplus P(x_l - 1)$ и $S_y = P(x_r) \oplus P(x_l - 1)$. Ово следи из својства истакнутог у претходном пасусу. Ако унапред израчунамо све потребне вредности $P$ можемо при сваком упиту рачунати $S_x$ и $S_y$ у константном времену, тј. решити задатак у укупној временској сложености од $\mathcal{O}(q)$. За чување вредности  $P$ нам је потребан низ одговарајуће дужине, па је укупна меморијска сложеност $\mathcal{O}(m+n)$, што је довољно за **трећи подзадатак** у ком важи $1\leq n,m \leq 10^6$.

Да бисмо дошли до оптималног решења смањићемо меморијску сложеност без погоршавања временске, тј. наћи начин да у константном времену израчунавамо вредности $P(a)$. За ово треба приметити још једно, мало компликованије, својство операције $\text{xor}$: 
$$
P(a) =
\begin{cases}
a & \text{за} ~ a = 4k \\
1 & \text{за} ~ a = 4k+1 \\
a+1 & \text{за} ~ a = 4k+2 \\
0 & \text{за} ~ a = 4k+3
\end{cases}
$$
До овог својства је могуће доћи посматрањем наивно израчунатих вредности $P(a)$ или директно из опсервације да свака четворка бројева $(4k, 4k+1, 4k+2, 4k+3)$ у бинарном систему има облик $(\bar{L}00, \bar{L}01, \bar{L}10, \bar{L}11)$. 

Сада имамо **оптимално решење**: за сваки упит у константном времену рачунамо вредности $P(a)$ потребне да би се добили $S_x$ и $S_y$. На основу њих, у зависности од парности димензија подматрице, рачунамо тражену вредност $S$. 
