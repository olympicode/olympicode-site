\## Анализа

Означимо (произвољну) тачку пробадања са $T$ и нека је њено растојање до најудаљенијег темена правоугаоника једанко $r_T$. Није тешко закључити да, окретањем око тачке пробадања, правоугаоник покрива површ која је заправо круг $K(T, r_T)$ са центром у $T$ и полупречником $r_T$. Дакле, треба изабрати тачку $T$ унутар правоугаоника такву да круг (укључујући и границу) $K(T, r_T)$ садржи што мање од датих $N$ тачака; oзначимо број тачка унутар поменутог круга са $c(T)$ а са $opt$ - оптимално решење (које треба израчунати).

Нека су темена правоугаоника $ABCD$, његов центар $O$ а $P_1$, $P_2$, $P_3$ и $P_4$, редом, средишта страница $BC$, $CD$, $DA$ и $AB$. Означимо са $a$ дуж $P_1P_3$ (хоризонтална средња линија) а са $b$ дуж $P_2P_4$ (вертикална средња линија). Нека су тачке у којима су такмичари $Q_1, Q_2, \ldots, Q_N$. Иако се најмања вредност $r_T$ достиже када је $T = O$, нама није битан само полупречник већ и позиција круга. Следећа лема представља кључно запажање:

**Лема:** Постоји тачка $T$ која припада $a \cup b$ и за коју је $c(T) = opt$.

Заиста, посматрајмо било коју оптималну тачку пробадања $T$ -- нека је, без умањења општости, у доњем-десном "квадранту" тј. правоугаонику $P_4BP_1O$. Тада је одговарајући круг $K(T, |TD|)$. Нека је $T'$ пресечна тачка дужи $TD$ и $a \cup b$ (ако их има више, нека је то пресечна тачка ближа $T$). Није тешко уочити да се пробадањем у тачки $T'$ добија круг $K'(T', |T'D|)$ који је цео садржан у кругу $K(T, |TD|)$ па важи $c(T') \leq c(T)$. Дакле, заиста је довољно разматрати само тачке на "средњим линијама правоугаоника" за оптималну тачку пробадања.

Најлакши начин је разликовање 4 случаја тј. тражење оптималне тачке на дужима $OP_1$, $OP_2$, $OP_3$ и $OP_4$. Размотримо случај када је тачка $T$ на $OP_1$ -- тада ће полупречник круга бити $|TD|$. Нека су $x$-координате тачака $O$ и $P_1$, редом, $L$ и $R$. Нека је $Q_i$ произвољна тачка и нека је $X_i$ пресек дужи $OP_1$ и симетрале дужи $Q_iD$ (уколико пресек постоји). Да би тачка $Q_i$ била ван круга $K(T, |TD|)$, тачка $T$ мора бити са "праве стране" тачке $X_i$; прецизније, ако је $Q_i$ "лево" од странице $CD$, мора важити $T \in (X_i, R)$ а ако је $Q_i$ "десно" од $CD$, мора важити $T \in (L, X_i)$. 

<img src="obaranje_sol.png" width=800 />

На овај начин добијамо највише $N$ подинтервала интервала $(L, R)$ и задатак се своди на одабир тачке из $(L, R)$ коју садржи највише поменутих интервала (одговарајући круг са центром у тој тачки неће садржати тачно оне тачке које одговарају интервалима које садрже тај центар). Ово се може решити на неколико начина а најлакши је сортирати крајеве интервала, свим левим крајевима доделити $+1$, свим десним $-1$ и одабрати тачку тако да је сума крајева интервала лево од ње највећа могућа. Сложеност овог алгоритма је $O(N \log N)$ због сортирања.

За лакшу имплементацију поменутог алгоритма, корисно је на почетку транслирати слику тако да је центар правоугаоника у $(0,0)$. Додатно, исти алгоритам се може искористити 4 пута (увек тражење центра на дужи $OP_1$) при чему се пре сваког позива цела слика ротира $90^\circ$ улево. Тражење одговарајућих тачака $X_i$ на дужи $OP_1$ се може урадити једноставном аналитичком геометријом (уколико je слика центрирана и за тачку $Q_i=(x_i,y_i)$ важи $x_i \neq x_D$, тада је пресек одговарајуће симетрале са $x$-осом управо у тачки $X_i = \frac{1}{2}(\frac{(y_i - y_D)(y_i+y_D) + (x_i + x_D)(x_i -x_D)}{x_i - x_D})$ ); вредност $X_i$ је могуће одредити и тернарном претрагом - тражење тачке (на датој дужи) која је подједнако удаљена од $D$ и $Q_i$.

**Подзадаци:** за први подзадатак је увек оптимално да центар буде у средишту дужи $AB$ (доња страница правоугаоника). За други подзадатак је довољна анализа неколико случајева (што се своди на проверу да ли два интервала имају пресек). У трећем подзадатку је довољно испитати да ли постоји тачка која је садржана у свим интервалима што се може урадити једноставније у $O(N)$; такође, могућ је и следећи приступ: за сваку тачку $Q_i$ одредимо геометријско место тачака оптималног центра тако да одговарајући круг не садржи дату тачку - може се показати да је тај скуп тачака у општем случају четвороугао; затим проверимо да ли је пресек свих таквих скупова непразан. У четвртом подзадатку је је довољно одредити тражену тачку на интервалу $(L,R)$ у сложености $O(N^2)$.


