Код прва два подзадатка било је довољно имплементирати било који ефикасан алгоритам за налажење минималног покривајућег стабла - у наставку MST од *minimum spanning tree*, такође, са $MSF$ ћемо означити минималну покривајућу шуму графа, тачније, то је подграф који је шума минималне тежине а има исте повезане компоненте, при чему је за први подзадатак био довољан било који тачан *brute force* приступ.

За 3. и 4. подзадатак могла је да се користи било која *2D* структура података која ефикасно одговара на упите "који је минимум у подматрици". За 3. подзадатак ($N=2$) довољно је само наћи грану минималне тежине. За 4. подзадатак ($N=3$) потребно је наћи минималну тежину гране међу свим гранама које спајају чворове $1,2$, аналогно за чворове $2,3$ и $1,3$. Уколико се међу овим гранама јавља једна или ниједна, онда стабло не постоји. Ако се јављају тачно две онда управо оне чине стабло, а ако се јаве три онда се стабло добија одбацивањем најтеже од те три гране. Најлакша за имплементацију (а ипак довољно брза) таква структура би била следећа асиметрична табела: За сваки подсегмент сваког реда израчунамо минимални елемент, ово радимо у сложености $O(R \times C^2)$, сваки упит решавамо у $O(R)$ пролазом кроз одговарајуће редове.

Да би се задатак решио за 100 поена кључна је следећа опсервација везана за појам MST-а:

Нека је $A$ скуп грана графа са чворовима $V = \{1, \ldots, N\}$, и нека је $T(A)$ минимална покривајућа **шума** тог графа (уколико их има више, онда било која). Тада важи следеће: $T(T(A) \cup T(B))$ је минимална покривајућа **шума** за скуп грана $A \cup B$. Ово се може доказати анализом рада *Kruskal*-овог алгоритма за налажење MST-а. У преводу, ово значи да, ако хоћемо да израчунамо $MSF$ за неки, потенцијално велики скуп грана, ми га можемо поделити на два мања скупа, који се чак могу и преклапати (потребно је само да је њихова унија једнака почетном скупу), затим наћи њихов $MSF$ а затим заједнички $MSF$ на сада већ знатно мањем скупу грана.

Ово нас усмерава ка томе да направимо дводимензиону *sparse table* структуру података, где ћемо за свако $i,j,k$ ($1 \leq i \leq R$, $1 \leq j \leq C$, $0 \leq k \leq \log_2(\min(R,C))$ чувати скуп грана који учествује у $MSF$-у скупа грана које се налазе у квадратној подматрици чије је горње лево теме поље $i,j$ а страница тог квадрата је $2^k$. Јасно је да се свако поље ове табеле може израчунати као унија четири поља где су странице квадрата дупло мање. Ако са $\alpha(N)$ означимо сложеност једне операције помоћне структуре података за дисјунктне скупове *(DSU, Disjoint Set Union)* а која је за овако мале вредности $N$ практично константна, тада се цела ова табела може конструисати у сложености $O(RC\log(\min(R,C))N \alpha(N))$.

Још једна кључна ствар је та што, услед тога што је количник страница правоугаоника код сваког упита број између $\frac23$ и $\frac32$, сваки овакав правоугаоник може да се "покрије" са највише $6$ квадрата чија је страница степен двојке, што нам омогућава да решимо сваки упит у сложености $O(N \alpha(N))$.