Средином 23. века људи са планете Земље су коначно развили технике међупланетарног путовања и кренули са освајањем свемира! Већ за две године су освојили $N$ планета, нумерисали их бројевима од 1 до $N$ и направили свемирске тунеле између неких од њих! Сви тунели су двосмерни и систем тунела је направљен тако да за сваке две планете постоји јединствен начин да се од једне дође до друге користећи ове тунеле и неке успутне планете. Може се закључити да тих тунела има тачно $N-1$ и да заједно са планетама образују структуру коју људи на Земљи називају стаблом. Ти тунели су заправо нека врста црних рупа и то нема пуно смисла али оно што је битно је чињеница да се овај задатак дешава у свемиру!

Осим што су у свемиру, ове планете имају и нека друга својства – за сваку планету је позната вредност $C_i$ која представља квалитет свемирских сарми на овим планетама; неке од ових вредности могу бити и негативне што је логично у свемиру. Познати кријумчар свемирских сарми Јуриј Маргарин је сковао свемирски план – изабраће две (не нужно различите) планете $A$ и $B$ и трејдоваће сарме на свим планетама (укључујући и ове две) које се налазе на (сетимо се) једниственом путу између $A$ и $B$. Јурију је наравно циљ да збир квалитета трејдованих сарми буде највећи могућ.

Једини проблем у целој овој свемирској причи је што Маргарина (и све нас) види Свемирска полиција, светлост универзума. Прецизније, постоји тачно $K$ свемирских патрола – за сваку је позната почетна и крајња планета $P_i$ и $Q_i$ ($P_i \neq Q_i$) њиховог патролирања и та патрола обилази све планете на јединственом путу између планета $P_i$ и Qi (укључујући и њих). Са ведрије стране, Јуриј Маргарин има довољно сарми у свемирском штеку да подмити највише једну свемирску патролу. Према томе, Јуриј мора изабрати пут са највећим збиром квалитета сарми али такав да се на том путу он може сусрести са највише једном патролом (можда више пута). Помозите му!

  

## Описи функција

Потребно је да имплементирате функцију

$$SvemirskiPut(N, K, t,pat, c[…])$$

где je $N$ – број планета, $K – број свемирских патрола, t низ дужине 2(N-1) који описују тунеле, pat низ дужине 2K који описујe патроле и c je низ квалитета дужине N. У низу t су, редом, наведени парови планета између којих постојоје тунели (постоји тунел између планета $t[0]$ и $t[1]$, између планета $t[2]$ и $t[3]$ и у општем случају између планета $t[2i]$ и $t[2i+1]$ за свако $i=[0,N-2]$). На потпуно исти начин низ pat описује парове планета између којих постоји свемирска патрола. На крају, за свако $i=[0,N-1]$ квалитет сарми на планети $i+1$ је $c[i]$. Сви низови су индексирани од 0. Ова функција мора да врати један цео број – највећи могући збир квалитета сарми на Маргариновом пут који задовољава горе поменуте услове.

  

## Пример:

Нека је N=9, K=3, t=[1, 3, 3, 9, 2, 4, 7, 8, 9, 8, 9, 6, 8, 5, 2, 9], pat=[4, 2, 3, 8, 7, 5] и c=[-3, 15, 20, 10, 20, 10, 20, 20, -2]. Ови подаци описују систем планета и тунела као на слици: плави кругови представљају планете при чему су њихови редни бројеви унутар кругова а бројеви поред њих представљају квалитет њихвих сарми; плаве линије предстаљају тунеле; остале линије представљају патроле – имамо 3 патроле, прва патролише између планета 2 и 4 (обилази обе), друга између планета 3 и 8 (обилази планете 3, 9 и 8) и трећа између планета 7 и 5 (обилази планете 5, 8 и 7). Јуриј ће најбоље трејдовати сарме ако изабере планете 3 и 6 – тада подмићује само другу патролу а укупан квалитет сарми на путу од 3 до 6 једнак 20 + (-2) + 10 = 28; боље од тога не може и то је број који ваша функција треба да врати. Приметимо да Јуриј нпр. не може изабрати пут између планета 3 и 4 или између 3 и 8 јер би се онда могао сусрести са две различите патроле.

![](https://lh7-us.googleusercontent.com/mx2YgwX_v0Fj1xkPWkMGmI-a0Rjp5PYQIjHxzjWWdtG3_x02hLXdvibxtaIZJTKnXOjofoWvyQB-bUeZhdGHKkT8eZvw2rh7hy3Eqqexd4G8zZ6CNkymEpuOdEEmZOksAPuD0UcsOXReIR_QiXimdV1rJRHiksKEBHYI7gRGNTCVgHi_avK-krlXNUE9JMHh)

## Ограничења

-   $2≤N≤200.000$
    
-   $1≤K≤200.000$
    
-   За свако $0≤i<2N-1$ важи $1≤t[i]≤N$
    
-   За свако $0≤i<2K$ важи $1≤ pat[i]≤N$
    
-   За свако $0≤i<K$ важи $pat[2i]≠pat[2i+1]$
    
-   За свако $0≤i<N$ важи $-10^9 \leq c[i] \leq 10^9$
    
-   Улазни подаци ће бити такви да ће између сваке две планете постојати јединствен пут
    
-   Улазни подаци ће бити такви да ће решење увек постојати
    

## Подзадаци и бодовање

-   ПОДЗАДАТАК 1 [15 ПОЕНА]: $N,K≤1.000$
    
-   ПОДЗАДАТАК 2 [15 ПОЕНА]: Планете су повезане на следећи начин: $1-2-3-⋯-n$
    
-   ПОДЗАДАТАК 3 [20 ПОЕНА]: Све сарме у свемиру су неквалитетне тј. $c[i]<0$ за свако $i$
    
-   ПОДЗАДАТАК 4 [20 ПОЕНА]: K≤100
    
-   ПОДЗАДАТАК 5 [30 ПОЕНА]: Нема додатних ограничења
    

  

## Детаљи имплементације

Потребно је да пошаљете тачно један фајл, под називом svemir.c, svemir.cpp или svemir.pas, који имплементира горе поменуту функцију. Осим тражене функције, ваш фајл може садржати и додатне глобалне променљиве, помоћне функције и додатне библиотеке.

Зависно од програмског језика који користите, ваша функција/процедура мора бити следећег облика:

C/C++

long long SvemirskiPut(int N, int K, int* t, int* pat, int* c);

Pascal

function SvemirskiPut(N, K : longint; var t, pat, c : array of longint) : int64;

  

Уколико радите у C/C++ -у, потребно је на почетку фајла ставити #include “svemir.h” а уколико радите у Pascal -у, потребно је на почетку фајла ставити Unit svemir; (ово је већ додато у фајловима који су вам обезбеђени).

  

## Тестирање и експериментисање

Уз задатак, обезбеђени су вам “template” фајлови (svemir.c, svemir.cpp, svemir.pas) које можете користити и мењати по потреби. Такође су вам обезбеђени програми (grader.c, grader.cpp, grader.pas) који служе да лакше тестирате кодове. Ови програми учитавају са стандардног улаза следеће податке:

-   У првом реду бројeve $N$ и $K$, редом
    
-   У наредном реду $2(N-1)$ бројева $t[i]$, раздвојених размаком
    
-   У наредном реду $2K$ бројева $pat[i]$, раздвојених размаком
    
-   У наредном реду $N$ бројева $c[i]$, раздвојених размаком
    

а затим позивају вашу функцију SvemirskiPut из одговарајућег фајла (svemir.c, svemir.cpp, svemir.pas) са учитаним параметрима и на крају вредност коју ваша функција враћа исписују на стандардни излаз. Kодове ових програма можете мењати по потреби.
