## Решење када $N, M \leq 500$

У овом случају, као решење можемо да за свако дете само избројимо колико постоји деце у сваком од $4$ квадранта. За ово напросто итерирамо кроз сву децу после сваког додавања, и са пар провера услова нађемо шмекера. Сложеност $O(N^3)$

## Решење када тачке имају исте $x$ и $y$ координате

У овом случају, можемо да видимо да је други услов тривијално испуњен, па само треба да нађемо дете за које важи да има једнако деце горе десно и доле лево. Ово је еквивалентно са тиме да ако посматрамо да су деца на правој, тражимо оног чија је позиција медијана низа. Стога нам је потребна нека структура која нам омогућава одржавање медијане низа у којем додајемо нове елементе. Ово може да се уради неким јаким структурама као `ordered statistic set`, али најелементарније решење би било да одржавамо две `heap` структуре, један где се чува највећих и други где се чува најмањих пола елемената. Када додајемо један елемент у низ, убацимо га у неки од њих, и онда највише једним пребацивањем можемо да одржимо тражену структуру.

## Решење када $N\leq 4000$

Приметимо да је услов да је неко дете шмекер еквивалентан са тиме да је његова $x$-координата медијана по свим $x$-координатама, и његова $y$-координата медијана по свим $y$-координатама. Заиста, ако је горе лево $a_1$, горе десно $a_2$, доле десно $a_3$ и доле лево $a_4$ деце, услов за медијане је $a_1+a_2=a_3+a_4$ и $a_1+a_4=a_2+a_3$, па сабирањем имамо $2a_1+a_2+a_4=a_2+2a_3+a_4\iff a_1=a_3$, из чега закључујемо и $a_2=a_4$, па дете које је по обе координате медијана је заиста шмекер. Обратно, ако је $a_1=a_3$ и $a_2=a_4$, услови $a_1+a_2=a_3+a_4$ и $a_1+a_4=a_2+a_3$ су тривијално испуњени, па смо доказали тражену еквиваленцију. 

Сада имамо врло лако решење у $O(N^2logN)$ тако што после сваког додавања по обе координате нађемо медијану у $O(NlogN)$, и у зависности од тога јел припада истом детету смо нашли шмекера или нашли да шмекер не постоји.

## Главно решење

Овде је неопходно само комбиновати идеје из претходна два подзадатка. Као у другом подзадатку одржавамо медијану, али засебно за $x$- и за $y$-координату у нашој омиљеној структури. Онда после сваког новог детета, видимо да ли су деца који одговарају тим медијанама једнаки. Укупна сложеност $O(NlogN)$.
