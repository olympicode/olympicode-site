Нека је $N$ број врста и нека је $M$ број колона. Претпоставимо да су врсте нумерисане бројевима од $0$ до $N-1$, а колоне бројевима од $0$ до $M-1$. 

Приметимо да не мора за сваки избор улазних података постојати решење. Наиме ако је $0\leqslant a_i < M$, онда то значи да се на пољу са координатама $(i,a_i)$ налази црно поље. Због тога број белих поља којима почиње колона $a_i$ није већи од $a_i$, па је $b_{a_i} \leqslant i$. Односно, ако је $0\leqslant a_i < M$ и $b_{a_i} > i$ за неко $i$, онда не постоји матрица која задовољава услове описане низовима $a$ и $b$. Слично, ако је $0\leqslant b_j < N$, онда је поље са координатама $(b_j, j)$ црно, па врста $b_j$ почиње са не више од $j$ белих поља и због тога је $a_{b_j} \leqslant j$. Дакле ако за неко $j$ ($0\leqslant j < M$) важи да је $0\leqslant b_j < N$ i $a_{b_j}>j$, онда не постоји матрица која задовољва услове описане низовима $a$ и $b$.

Претпоставимо да постоји матрица описана низовима $a$ и $b$. Тада за свако $i$ за које је $0\leqslant a_i < M$ важи да је поље са координатама $(i,a_i)$ црно. Слично, ако за неко $j$ важи да је $0\leqslant b_j < N$, онда је поље са координатама $(b_j,j)$ црно.  И то је минимални скуп црних поља. Према томе, број црних поља ћемо одредити тако што избројимо колико има различитих поља у унији скупова
$$
A=\{(i,a_i)|0\leqslant i < N, 0\leqslant a_i < M\}
\quad \text{и} \quad
B=\{(b_j,j)|0\leqslant j < M, 0\leqslant b_j < N\}.
$$

Претпоставимо да постоји матрица која задовољава услове описане низовима $a$ и $b$. Тада могу бити црна сва поља $(i,j)$ ($0\leqslant i < N$, $0\leqslant j < M$) која задовољавају и следећа два услова:
$$
a_i \leqslant j < M
\quad \text{и}\quad
b_j \leqslant i < N.
$$


## Решење кад је $N,M \leq 4$
У овом случају се могу испитати све матрице димензија $N\times M$ чија су поља бела или црна (тј, за сваку од њих се може проверити да ли задовољава услове описане низовима $a$ и $b$). Наиме матрица има $2^{N M} \leqslant 2^{16} = 65536$. Након тога се лако одреди број црних поља у матрици која има најмањи и/или највећи број црних поља.

## Решење кад је $N,M \leq 1.000$

У овом случају се за свако поље матрице одређује да ли је црно, за варијанту када треба да одредимо најмањи број црних поља и/или за варијанту када треба да одредимо највећи број црних поља. За одређивање боје користимо горе наведене услове. Сложеност овог решења је $\Theta(NM)$.

## Решење кад је $N, M \leq 100.000$

Опишимо како одређујемо максимални број црних поља (опет ћемо претпоставити да постоји матрица која задовољава услове проблема). Максималан број црних поља одређујемо тако што одређујемо максималан број црних поља у врстама полазећи од нулте врсте и обрађујући их редом. Ако тренутно обрађујемо врсту са редним бројем $i$, онда могу бити црна сва поља $(i,j)$ која задовољавају услове $j\geqslant a_i$ и $b_j \leqslant i$. Један од начина да то урадимо је да дефинишемо помоћни низ $c$ дужине $M$ чији елементи на почетку имају вредност $0$, а ако се тренутно обрађује врста број $i$, онда ће вредности елемената низа $c$ бити
$$
c_j = \begin{cases}
1,\quad &\text{ако је }b_j\leqslant i\\
0,\quad &\text{ако је }b_j > i.
\end{cases}
$$
Тада ће највећи број црних поља у врсти број $i$ бити
$$
c_{a_i} + c_{a_i+1} + c_{a_i+2} + \dotsb + c_{M-1}.
$$
Ове збирове ћемо најефикасније одредити користећи Фенвиково стабло (Fenwick tree) или сегментно стабло. Приметимо да се низ $c$ (потенцијално) мења при обради сваке врсте, па у складу са тим треба ажурирати и одговарајуће стабло. Сложеност овог решења је $\Theta(N\log M)$.


Минимални број црних поља можемо одредити тако што формирамо скуп састављен од парова $(i,a_i)$ ($0\leqslant i < N$, $a_i < M$) и $(b_ј,ј)$ ($0\leqslant j < M$, $b_j < N$), а затим избројимо колико у том скупу има елемената. 

