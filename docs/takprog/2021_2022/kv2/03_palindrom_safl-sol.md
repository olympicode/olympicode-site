
Са $N$ ћемо означити дужину дате ниске, са $\Sigma$ број карактера у алфабету, у нашем случају $26$.

## Решење када су два слова 'b', а остала ‘а’

Оптимално решење у овом случају је или померити оба слова на два централна поља или померити једно слово на позицију симетричну позицији другог слова.

## Решење када $N \leq 50$

Задатак можемо решити тако што претпоставимо леву и десну границу оптималне подниске, $i$ и $j$, респективно (број могућности је $\Theta(N^2)$). За сваку могућност $(i,j)$, у линеарном времену проверимо да ли је могуће извршити шафл тако да је резултујућа ниска палиндром. Посматрамо интервал $[i,j]$ и симетрични интервал $[n-j+1, n-i+1]$. Уколико изван ова два интервала, улазна ниска није палиндромска, тада је немогуће променити било шта у $[i,j]$ тако да решење постане палиндром. Другим речима, претпоставка $[i,j]$ није валидна. У супротном, када интервал $[i,j]$ не садржи средину ниске, довољно је проверити да за свако слово важи да je његова учестаност у $[i,j]$ иста као и његова учестаност у $[N-j+1, N-i+1]$. Када $[i,j]$ садржи средину ниске, провера је слична, само у обзир треба узети и преклапања интервала $[i,j]$ и $[N-j+1, N-i+1]$.

## Решење када $N \leq 3000$
Претходна идеја се може убрзати ако приметимо да када фиксирамо два краја проверу можемо извршити у временској сложености $O(\Sigma)$.

## Главно решење
Посматрајмо најпре највећи број $l$, такав да је префикс ниске дужине $l$ једнак суфиксу дужине $l$ у обрнутом редоследу. Оптимално решење никада неће садржати првих $l$ и последњих $l$ слова ниске. Најпре ћемо проверити да ли је могуће извршити шафл на само левој половини ниске. То проверавамо тако што тражимо најмањи индекс $i_1 \le |T|/2$ такав да за свако слово важи да је његова учестаност у интервалу $[l+1,i_1]$ истa као и његова учестаност у интервалу $[N-i_1+1, N-l]$ и да је улазна ниска палиндром у интервалу $[i_1, N-i_1]$. Уколико такав индекс постоји кандидат за решење је интервал $[l,i_1]$.

У наставку ћемо претпоставити да оптимално решење садржи средишњи део ниске и почиње од индекса $l+1$. (Пошто су по дефиницији вредности $l$ слова у нисци на позицијама $l+1$ и $N-l$ различита, оптимална подниска мора увек садржати бар једну од ове две позиције. У имплементацији је потребно проверити оба случаја појединачно.) Тражимо најмањи индекс $i_2 > N/2$ такав да за свако слово важи да је његова учестаност у интервалу $[i_2+1, N-l]$ мања или једнака његовој учестаности у интервалу $[l+1, i_2]$. Уколико такав индекс постоји, кандидат за решење је интервал $[l+1, i_2]$. Ово можемо гарантовати, јер нам се гарантује да ће постојати такав интервал. Из тога можемо закључити да ће и ,,централни део’’ моћи да се испремешта да буде палиндром.

Учесестаност слова у интервалима можемо одредити коришћењем префиксних сума и описано решење је могуће имплементирати у временској сложености од $O(N \cdot \Sigma)$. Мало пажљивија имплементација даје временску сложеност од $O(N)$. Постоје и алтернативна решења задатка која користе бинарну претрагу или претраживачка стабла и раде у сложености $O(N \log N)$, што је такође довољно за све поене на овом задатку.
