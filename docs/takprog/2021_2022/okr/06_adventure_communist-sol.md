## Решење за $N, T \leq 2000$

Овде је довољно симулирати дешавања тренутак по тренутак у сложености $O(NT)$.

## Решење за $N\leq 200$

У овом случају је потребно приметити да је описана рекурента веза заправо линеарна трансформација која се може представити у матричном облику kao
$$A(t+1)=K \cdot A(t)$$ gde је
$$A(t) = [a_0(t), a_1(t), ..., a_n(t)]^T$$
 $$K_{i,i} = C \text{  ,  } K_{i,i+1} = (i+1) \cdot K_{i+1}$$
 $$K_{ij}=0 \text{  за  } (j!=i) \wedge (j!=i+1)$$

Одавде се добија следећа једнакост:
$$A(t)=K^t \cdot A(0)$$
из које можемо одредити вредност $a_0(T)$ у сложености $O(N^3\log T)$ брзим степеновањем матрица.


## Решење за $C = 1$

Приметимо прво да се допринос сваке појединаче фабрике може посматрати одвојено од осталих зато што је описана трансформација линеарна. Укупан број кромпира у тренутку $T$ добијамо као збир доприноса сваке фабрике.

За трансформацију
$$a_i(t+1)=a_i(t)+(i+1) \cdot K_{i+1} \cdot  a_{i+1}(t)$$
се може индукцијом доказати да је допринос $i$-те фабрике укупном броју кромпира након $t$ секунди заправо:
$$d_i = \prod_{j=1}^{i} K_j \cdot (t-j+1)$$
Сумирањем свих доприноса добијамо:
$$a_0(T) = a_0(0) + \sum_{i=1}^{N} a_i(0) \cdot d_i = a_0(0) + \sum_{i=1}^{N} a_i(0) \cdot \prod_{j=1}^{i} K_j \cdot (T-j+1)$$
На основу овог израза можемо одредити $a_0(T)$ у сложености $O(N)$.

## Главно решење:

Приметимо да се задата рекурентна веза може записати као:
$$a_i(t+1)=C \cdot a_i(t)+(i+1) \cdot K_{i+1} \cdot a_{i+1}(t)= C \cdot (a_i(t)+(i+1) \cdot \frac{K_{i+1}}{C} \cdot a_{i+1}(t))$$
У матричном облику ова рекурентна веза може се записати као композиција две линеарне трансформације на следећи начин:
$$A(t+1)=C \cdot I \cdot K' \cdot A(t)$$ gde је
$$A(t) = [a_0(t), a_1(t), ..., a_n(t)]^T$$
 $$K_{i,i} = 1 \text{  ,  } K_{i,i+1} = (i+1) \cdot \frac{K_{i+1}}{C}$$
 $$K_{ij}=0 \text{  за  } (j!=i) \wedge (j!=i+1)$$
 и матрица $I$ је јединична матрица.

 Одавде се добија следећа једнакост:
$$A(t)=C^t \cdot K'^{t} \cdot A(0)$$
Пошто је матрица $K'$ иста као у случају када је $C=1$ можемо закључити да је допринос $i$-те фабрике:
$$d_i = C^t \prod_{j=1}^{i} \frac{K_j}{C} \cdot (t-j+1) = C^{t-i} \cdot \prod_{j=1}^{i} K_j \cdot (t-j+1)$$
Сумирањем свих доприноса добијамо:
$$a_0(T) = a_0(0) + \sum_{i=1}^{N} a_i(0) \cdot d_i = a_0(0) + \sum_{i=1}^{N} a_i(0) \cdot C^{T-i} \cdot \prod_{j=1}^{i} K_j \cdot (T-j+1)$$
На основу овог израза можемо одредити $a_0(T)$ у сложености $O(N)$.
