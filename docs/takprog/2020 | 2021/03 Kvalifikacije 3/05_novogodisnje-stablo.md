Назовимо родитељем чвора $x$ (који није корен) први чвор на који наиђемо када од $x$ кренемо ка корену (чвору $1$). Најбитнији закључак је онда да је број компоненти исте боје једнак броју чворова који су другачије обојени од свог родитеља, плус један. Овакве чворове ћемо од сад звати *лепи чворови*. Ово важи, јер ако за сваку компоненту узмемо чвор који је најближе корену, знамо да је његов родитељ друге боје. Самим тим постоји бијекција између броја компоненти и лепих чворова (плус један додајемо због компоненте у којој се налази сам корен).

На почетку, потребно је да једним проласком кроз стабло нађемо родитеља сваком чвору (ДФС обиласком из корена) и избројимо колико на почетку има лепих чворова. Сада посматрајмо шта се деси када подстабло чвора $u$ обојимо бојом $c$. Сви лепи чворови унутар строгог подстабла $u$ (подстабла не рачунајући чвор $u$) нестају (јер сви чворови у том подстаблу сад имају исту боју), а сам чвор $u$ је леп чвор уколико је $c$ различито од боје његовог родитеља. 

Скуп лепих чворова можемо одржавати на пример користећи бинарно претраживо стабло (односно *set* у C++). Такође се може користити сегментно стабло са лењом пропагацијом. За чување података о томе који чвор је које боје морамо користити сегментно стабло са лењом пропагацијом (или сличну структуру). Ово ћемо радити над ДФС обиласком стабла, односно *спљоштеним* стаблом. Крајња временска сложеност је $O(N+QlogN)$ или $O((N+Q)logN))$, у зависности од имплементације.
