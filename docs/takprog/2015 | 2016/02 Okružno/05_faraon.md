# Фараон

Аутор: Демјан Грубић
Текст и тест примери: Демјан Грубић 
Анализа решења: Младен Пузић
Тестирање: Димитрије Ердељан

Означимо са $d$ највећи заједнички делилац бројева $p$ и $q$. Прво ћемо број $p$ поделити са $p/d$, тако да добијемо број $d$, па га помножити са $q/d$, тако да добијемо $q$. То, наравно, радимо једним по једним простим бројем. Тако добијамо $q$ од $p$, а оптимално је, јер нема потребе да даље делимо $p$ након што га спустимо до $d$.

Остаје нам само да ефикасно факторишемо бројеве $p/d$ и $q/d$ и тако избројимо број корака који су нам потребни (што је збир експонената у канонској факторизацији тих бројева).

### Решење за $N \leq 10^4$
Пошто је $N$ мало, можемо мање ефикасно факторисати бројеве. Конкретно, можемо то урадити у сложености $О(\sqrt x)$, за број $x$ који факторишемо. То можемо урадити тако што ћемо проћи редом кроз све бројеве од $2$ до $\lfloor \sqrt x \rfloor$ и делити број $x$ њима докле год је могуће. Овако ћемо га увек делити простим факторима, јер кад дођемо до сложеног броја, ниједан њихов прости чинилац више неће делити $x$. Уколико нам остане број који је већи од $1$ и тај број је прост фактор броја $x$ (ово је тачно јер број $x$ може имати највише један прост фактор који је већи од $\lfloor \sqrt x \rfloor$). Укупно ће простих фактора бити највише $\lceil \log_2{x} \rceil$, па дељење њима не утиче на сложеност.

Временска сложеност је $O(N\cdot (\sqrt p + \sqrt q)$), а меморијска $O(1)$.

### Решење за $p, q \leq 10^5$
Користићемо исту факторизацију као у претходном решењу, само што ћемо, пре него што одговоримо на било које питање, израчунати број простих фактора свих бројева од $1$ до $M$ (у овом случају $M = 10^5$). Након тога користимо те информације како бисмо у $O(1)$ одговорили на свако питање.

Временска сложеност је $O(N\log M + M \sqrt {M})$, а меморијска $O(M)$.


### Главно решење
Потребно је да факторизацију урадимо ефикасније. Користимо модификовано Ератостеново сито, пошто су нам бројеви до $10^6$, да пре свих питања израчунамо следеће: 
- за сваки број $x$ од $1$ до $M$, који је најмањи прост број који дели $x$?

Када наиђемо на прост број, за све његове множиоце проверићемо да ли они већ имају мањег простог делиоца. Уколико не, онда је у питању наш тренутни прост број. Када имамо ову информацију, збир експонената у канонској факторизацији $x$ је само број корака који нам је потребан да доведемо $x$ до $1$, увек га делећи са његовим најмањим простим делиоцем. Тих корака ће бити највише $\lceil \log_2{x} \rceil$.

Временска сложеност је $O(maxPQ \log maxPQ + N log)$


