За први подзадатак решење које рачуна суму подматрице елемент по елемент тј. решење сложености $O(nmq)$ је довољно брзо.

За подзадатак где је $M=2$, уколико је висина $H$ или ширина $W$ подматрице паран број, одговор је $\frac{WH}{2}$. У супротном (ако су оба непарна), решење је $\frac{WH + x}{2}$, где је $x$ вредност у горњем левом углу матрице. Ово проистиче из чињенице да матрица изгледа као шаховска табла.

За подзадатак где је $n,m \leq 1000$, можемо израчунати $2D$ префиксне суме, односно за свако $u,v$ вредност $P_{u,v} = \sum_{i\leq u, j \leq v} A_{i, j}$. За ове вредности важи следећа веза: $P_{u,v} = P_{u-1,v} + P_{u,v-1} - P_{u-1,v-1} + A_{u,v}$. Након тога, вредност у подматрици $(x_l, y_l) - (x_r, y_r)$ налазимо као $P_{x_r,y_r}+P_{x_l-1,y_l-1}-P_{x_r, y_l-1}-P_{x_l-1,y_r}$. Временска сложеност је $O(nm+q)$.

Четврти подзадатак се решава исто као последњи, с тим што за поједине математичке суме није неопходно тражити формулу сложености $O(1)$ већ се могу израчунати унапред све вредности у линеарној сложености по $n,m$.

Решење за максимални број поена се састоји од тога да се матрица подели на три дела, затим се сваки од тих делова дели на три поддела, а за сваки од њих се сума може израчунати у $O(1)$, па је укупна временска сложеност $O(1)$ по упиту односно $O(q)$. Уколико је матрица правоугаона, први део биће једнакокрако-правоугли троугао коме је катета краћа ивица (горња или лева) а прав угао му је у горњем-левом темену подматрице. Слично, други део биће једнакокрако-правоугли троугао коме је прав угао у доњем-десном темену подматрице а катета му је краћа ивица (десна или доња). Трећи део је остатак ове подматрице који ће имати облик паралелограма (овај део може бити празан). У случају да је дата подматрица квадратна можемо узети да доњи десни троугао има за $1$ краћу катету од горњег левог, а трећи део (паралелограм у средини) ће опет бити празан.

Затим, сваки од ових делова делимо на подделове. Сваки од делова ће се састојати од скупа споредних дијагонала таквих да су унутар дијагонале сви бројеви једнаки. Код првог дела (горњи/леви троугао), ове дијагонале имају растуће дужине, код другог дела (доњи/десни троугао) оне имају опадајуће дужине, а код трећег (средњег) дела оне имају једнаке дужине. Сваки од делова делимо на три поддела: Средњи од ових подделова се састоји максималног броја поддијагонала које редом узимају вредности $0, 1, 2, \ldots, M-1$, док су остала два дела леви и десни остаци. За рачунање суме унутар сваког од ових подделова можемо користити следеће идентитете:

* $\sum_{i=1}^n i = \frac{n(n+1)}{2}$
* $\sum_{i=1}^n i^2 = \frac{n(n+1)(2n+1)}{6}$

Неке од последица које су корисне при рачунању сума су:

* $\sum_{i=1}^n (a+i)(b+i) = abn + \frac{n(n+1)(2n+1)}{6} + \frac{(a+b)n(n+1)}{2}$
* $\sum_{i=1}^n (a+i)(b-i) = abn - \frac{n(n+1)(2n+1)}{6} + \frac{(b-a)n(n+1)}{2}$
