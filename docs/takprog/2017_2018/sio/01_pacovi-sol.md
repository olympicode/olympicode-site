Решење задатка се оквирно може поделити на две фазе: У првој, идентификујемо на којим позицијама се налазе стрингови из низа $B$ у стрингу $A$, где $A$ посматрамо као цикличан стринг. У другој, проверавамо колико најмање стрингова из $B$ нам треба да бисмо направили стринг еквивалентан стрингу $A$.

## Прва фаза - тражење стрингова

Један од ефикаснијих начина да се ово уради јесте да се скуп стрингова из $B$ представи у облику _Trie_ структуре података. Затим, за сваку полазну позицију $i$ у стрингу $A$ крећемо се унапред низом слова $A_i, A_{i+1}, \ldots A_j$. Ако "излетимо" из стабла _Trie_ прекидамо и настављамо са наредном вредношћу $i$. Иначе, ако се налазимо у чвору који одговара неком стрингу из $B$ памтимо да је $A_i, \ldots, A_j \in B$. Овај део ради у временској сложености $O(N^2 + \sum L_i)$.

## Друга фаза - налажење минималног броја стрингова

Претпоставимо да је стринг $A$ апериодичан. Уколико није, налазимо његову најмању периоду. Приметимо да се права може поплочати на еквивалентан начин поплочавању стрингом $A$ ако и само ако постоји неки низ стрингова $S_1, S_2, \ldots S_k$ из $B$ који покривају позиције $[x_1, x_2-1], [x_2, x_3-1], \ldots, [x_{k-1}, x_k-1]$ где је $x_k = x_1$. Стога, правимо граф са $N$ чворова и стављамо грану $(i, j)$ уколико је $A_i, \ldots, A_{j-1} \in B$, а затим тражимо најкраћи циклус у графу. У случају да $A$ није апериодичан, у обзир долази сваки пут који води од чвора $i$ до чвора $j$ где важи $d | i-j$, где је $d$ дужина најкраће периоде. Налажење најкраћег пута односно циклуса у овом графу је најједноставније урадити *Флојд-Варшаловим* алгоритмом, у свега 4 линије кода. Овај део ради у временској сложености $O(N^3)$.