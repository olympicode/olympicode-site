Прво, за сваки број са улаза нађимо све различите просте бројеве који га деле. Ово се може урадити ефикасно помоћу модификације Ератостеновог сита, којом се сваки број $x < M$ може факторизовати у логаритамској сложености, где је $M$ горња граница за Ератостеново сито.

Ових различитих простих бројева има не више од $6$, јер је производ најмањих $7$ простих бројева већи од $2 \times 10^5$. Сада, за сваки број нађимо количник њега и сваког различитог простог броја који га дели. Нека је за $i$-ти број $P_i$ листа његових различитих простих делилаца а $C_i$ листа  која се добија када се $A_i$ подели са сваким елементом листе $P_i$. Циљ задатка је да нађемо низ различитих бројева $B$ тако да је за свако $i$, $B_i = A_i / P_{i, j} = C_{i, j}$ за неко $j$. Овај проблем је познат и под називом систем различитих представника фамилије скупова $C$. Ово се може решити у полиномијалном времену тако што се представи као бипартитни граф, где су чворови са леве стране индекси из оригиналног низа, а са десне стране количници. За свако $i$ додајемо грану од чвора $i$ са леве стране до чворова $C_{i, j}$ са десне, за свако $j$. Сваки систем различитих представника сада одговара једном перфектном спаривању (мечингу) у овом графу, односно мечингу где је сваки чвор са леве стране спарен. Дакле желимо да испитамо да ли овако добијен граф има мечинг са $N$ грана и који је то мечинг.

Најједноставнији и најпознатији алгоритам јесте Форд-Фулкерсонов алгоритам који ради у сложености $O(VE)$, где је $V$ број чворова, а $E$ број грана у графу, што у нашем случају, због горе поменутог ограничења на број грана износи $O(N^2)$. Приметимо да не морамо да додајемо све чворове са десне стране већ само оне који се бар једном појављују као количници.