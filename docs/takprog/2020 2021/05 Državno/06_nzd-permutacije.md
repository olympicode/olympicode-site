# НЗД пермутације

Аутор: Тадија Шебез
Текст и тест примери: Тадија Шебез
Анализа решења: Тадија Шебез
Тестирање: Алекса Плавшић

### Решење за $N \leq 9$
Можемо да изгенеришемо све пермутације и нађемо тражени збир.

### Решење за остале подзадатке
Приметимо да се свака два броја из низа $A$ појављују као суседни у тачно $2 (N-1)!$ пермутација, па је решење збир највећих заједничких делилаца свих парова пута $2 (N-1)!$. Када је $N \leq 1000$ можемо да прођемо кроз све парове, док је код остала два подзадатка потребно прво пребројати колико се пута која вредност појављује у низу.

### Решење за 100 поена
Нека је $cnt_i$ број појављивања броја $i$ у низу, а $d_i$ број чланова низа који су дељиви са $i$. Низ $d_i$ се може наћи по формули $d_i = \sum_{j=1}^{i*j \leq M} cnt_{i*j}$ у $O(M log M)$ где је $M$ највећи број у низу. Нека је $dp_i$ број парова чији је НЗД једнак $i$. Приметимо да је $\binom{d_i}{2}$ број парова чији је НЗД дељив са $i$, па када од тога одузмемо број парова чији је НЗД једнак $2i$, $3i$, ... добијамо број парова чији је НЗД једнак $i$. Сада можемо израчунати низ $dp$ од $dp_n$ до $dp_1$ по формули $dp_i = \binom{d_i}{2} - \sum_{j=2}^{i*j \leq M} dp_{i*j}$. Временска сложеност решења је $O(M log M)$, а меморијска $O(M)$.

Напомена: Рачунање низова $d_i$ и $dp_i$ је сложености $O(M log M)$ јер се за њихово израчунавање пролази кроз цео низ, па кроз сваки други члан, затим кроз сваки трећи, ... У збиру то је $\sum_{i=1}^{M} \lfloor \frac{M}{i} \rfloor$ што је приближно једнако $M$ пута $H_M = \sum_{i=1}^{M} \frac{1}{i}$. $H_n$ су хармонијски бројеви и они се понашају као природни логаритам.