Да бисмо могли да нађемо минималан број операција за изједначавање
свих кула, прво нам је потребан начин да одредимо минималан број
операција потребан да би се једној кули додало $К$ коцкица. Ово није
могуће ако $К = 1$, јер је свака операција додаје барем две
коцкице. Ако $К \leq 2$, оптималан алгоритам је:

* док $К$ није дељиво са $3$, додај две коцкице (и самим тиме смањи
  $К$ за $2$)
* додај $К/3$ група од по три коцкице

Јасно је да је овај алгоритам оптималан у случају у ком је $К$ дељиво
са $3$. Ако $К$ није дељиво са $3$, сигурно морамо да искористимо
барем једну групу од две коцкице, а ако претпоставимо да је наш
алгоритам оптималан за $К-2$ коцкице, по индукцији је оптималан за
свако $К$ (где су базни случајеви $К=2$ и $К=3$, за које је потребна
једна група).

Приметимо да ове вредности (минимални бројеви операција) расту са К
(почев од $К=2$, вредности су: $1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4,
\dots$ -- свака после $1$ се понавља три пута). Дакле, минималан
укупан број операција се постиже тако што одаберемо најмању "циљну
висину" $T$ на коју можемо довести висине свих кула.

Пошто не можемо "смањивати" куле, ово $Т$ мора бити веће или једнако
од свих вредности $A_i$. Такође не сме бити једнако са $A_i$ ни за
једно $i$, пошто куле не можемо повећати за само једну коцкицу. Ако је
$М$ максимална вредност у низу $A_i$, имамо две могућности:

* $М-1$ се не јавља у $А$ -- оптимално је $Т=M$
* у супротном, не можемо користити $Т=М$ (због $М-1$) ни $Т=М+1$ (због
  $М$) -- оптимално је $Т=М+2$

Након што одредимо оптималну вредност за $T$, потребно је само да
саберемо број потребних коцкица за сваку кулу на основу описаног
алгоритма. Како $T$ можемо одредити једним пролазом кроз низ (где
памтимо највећи и други највећи елемент), а број додатих коцкица у
$\mathcal{O}(1)$ по кули (јер ћемо највише двапут додати две коцкице),
укупна сложеност алгоритма је $\mathcal{O}(N)$.
