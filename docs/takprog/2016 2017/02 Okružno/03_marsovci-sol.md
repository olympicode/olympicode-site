## Подзадатак $1$
У првом подзадатку, довољно добро је и *bruteforce* решење. Проласком кроз сваки могући подниз узастопних Марсоваца одређујемо максималну и минималну висину у њему, њихову разлику, и бројимо поднизове где је та разлика максимална. Овај приступ има временску сложеност $O(N^3)$.

## Подзадатак $2$
Мала модификација претходног приступа може довести до временске сложености $O(N^2)$. Ако пролазак кроз све поднизове вршимо тако што фиксирамо леву границу $L$, а затим померамо десну границу $R$, можемо у $O(1)$ наћи максимум и минимум у сваком поднизу на основу претходно израчунатих решења. Конкретнo, имамо да је $max(H_L, H_{L+1}, \dots, H_{R+1}) = max(max(H_{L}, H_{L+1}, \dots, H_{R}), H_{R+1})$. Слично важи и за минимум.

## Подзадатак $3$
У овом моменту, неопходно је направити пар битних опсервација које представљају први корак ка комплетном решењу задатка.

Означимо са $H_{min}$ и $H_{max}$ висину најнижег, односно највишег Марсовца. Сада примећујемо да је највећа могућа разлика највишег и најнижег Марсовца у неком поднизу узастопних Марсоваца једнака $H_{max} - H_{min}$. Већу разлику није могуће добити, а управо ова разлика се добија у било ком поднизу у ком је $H_{max}$ максимум а $H_{min}$ минимум - нпр. цео низ. Такође, важи да је максимум у неком поднизу једнак $H_{max}$ ако и само ако се у њему налази бар једна вредност $H_{max}$ (слично важи и за минимум). Сада се задатак може свести на бројање поднизова који садрже барем једног Марсовца висине $H_{max}$ и барем једног Марсовца висине $H_{min}$. 

Додатни услов који овај подзадатак уноси је да се вредности $H_{min}$ и $H_{max}$ појављују тачно једном у низу висина. Означимо индекс (јединственог) највишег Марсовца са $i_{max}$ а најнижег са $i_{min}$ и узмимо да је (не умањујући општост) $i_{max} < i_{min}$. Сада до решења долазимо у константном времену, уз мало рачуна. Како лева граница подниза не сме бити већа од $i_{max}$ (иначе се $H_{max}$ не налази у том поднизу), а десна мања од $i_{min}$ (иначе се $H_{min}$ не налази у том поднизу) број поднизова који садрже и $H_{min}$ и $H_{max}$ је једнак $(i_{max} + 1) * (N - i_{min})$. Временска сложеност овог приступа је $O(n)$.

## Подзадатак $4$
Овде је потребно мало компликованије решење, будући да додатни услов из претходног подзадатка не важи, па највиши (тј. најнижи) Марсовац не мора бити јединствен. Бројању поднизова приступамо тако што померамо бројач $L$ од почетка до краја низа и у сваком кораку рачунамо колико има поднизова чија је лева граница $L$ а да садрже барем једног Марсовца висине $H_{max}$ и барем једног Марсовца висине $H_{min}$. Како бисмо ово ефикасно израчунали у току целе процедуре одржавамо два показивача $firstMax$ и $firstMin$ који, за тренутно $L$, показују на прво појављивање Марсовца висине $H_{max}$ (односно $H_{min}$)  од позиције $L$ па до краја низа (укључујући и $L$). Како је лева граница подниза фиксирана на $L$, а десна граница не сме бити мања од $max(firstMax, firstMin)$, у сваком коракy на коначно решење додајемо $N - max(firstMax, firstMin)$. 

Остало је још да продискутујемо како се ови показивачи ефикасно одржавају: ако након инкрементовања $L$ важи $firstMax>=L$ није потребна корекција, а у супротном увећавамо $firstMax$ за један све до првог наредног појављивања $H_{max}$ (ако наредно појављивање не постоји, можемо одмах престати са бројањем и исписати тренутно решење). Аналогно одржавамо и други показивач.

Иако се у једном кораку увећање поменутих показивача може догодити и до $N$ пута, у току целе процедуре ће они, као и $L$, прећи пут од почетка до краја низа, па је укупна временска сложеност решења $O(n)$.
