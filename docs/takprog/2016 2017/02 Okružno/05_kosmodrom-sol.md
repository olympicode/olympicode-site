##Главно решење
Да бисмо одредили пронашли оптимално решење, испробаћемо свих $N + 1$
могућих избора за број преврнутих кутија $K$ (где $0 \leq K \leq
N$). Неопходно је да за свако $K$ одредимо највеће чекање, и онда је
укупно решење минимум тих вредности.

Највеће чекање ћемо одредити тако што за сваку ракету израчунамо
колико ће чекати и узмемо максимум тих вредности. Ово можемо да
урадимо у $O(N^3)$ -- након што "окренемо" првих $K$ елемената низа
$T$, за сваку кутију знамо да ће се "ослободити" када све кутије изнад
ње буду однесене, тј. да ће $i$-та кутија бити на врху гомиле у
тренутку $max(T_j : j < i)$ и самим тим чекати $min(0, T_i - max(T_j :
j < i))$ (на кутију не може да се чека негативно дуго). Рачунање ових
максимума у линеарном времену (пролажењем кроз $T$) даје укупно
квадратну сложеност за одређивање чекања свих ракета (за фиксно $K$).

Ако за рачунање горе описаних максимума искористимо већ израчунату
вредност за претходни елемент низа (посматрамо максимум претходне
вредности и тренутног елемента $T_{i-1}$), можемо одредити сва чекања
у једном пролазу кроз низ, тако да је укупна сложеност $O(N^2)$
($O(N)$ за свако $K$).

За фиксно $K$, кутије можемо поделити у две групе -- оне које су у
преврнутом делу гомиле и кутије испод преврнутог дела. Означимо
максимална чекања у ове две групе са $U_K$ и $D_K$ редом.

За фиксно $К$, највеће чекање у окренутом делу гомиле је узроковано
или једном од кутија из првих $К-1$ (у оригиналном низу) која чека на
$К$-ту (сада горњу), или чекањем једне од првих $К-1$ на другу из
истог скупа. Прва вредмост се може одредити као $min(0, T_K - max(T_i
: i < K))$, а друга је једнака $U_{K-1}$, тако да се цео низ $U$ може
израчунати у $О(N)$ (опет, неопходно је да памтимо максимуме свих
префикса и рачунамо их као у претходном делу).

Пошто на кутије које нису окренуте не утиче распоред кутија изнад њих,
за времена чекања која утичу на $D_K$ можемо узети времена за $K=0$
(која рачунамо у $O(N)$ на раније описан начин), где је $D_K$ максимум
суфикса овог низа. Као и за чекања, ово можемо одредити у једном
пролазу (уназад), на основу већ израчунатог $D_{K+1}$.

Након што у линеарном времену израчунамо низове $U$ и $D$, коначно
решење је најмања вредност $max(U_i, D_i)$, тако да је укупна
сложеност алгоритма $O(N)$.